<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>인형뽑기방 정보 - 지도</title>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Kakao Map API -->
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=719ae502dd3351fab0a5fa57689ef5cd&libraries=services,clusterer"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: #fafafa;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header Styles */
        .app-header {
            background-color: #6200ea;
            color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 64px;
        }

        .header-logo {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 20px;
            font-weight: 500;
            text-decoration: none;
            color: white;
            cursor: pointer;
        }

        .header-logo .material-icons {
            font-size: 28px;
        }

        .header-nav {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .nav-item {
            padding: 8px 16px;
            border-radius: 4px;
            text-decoration: none;
            color: white;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: background-color 0.2s;
            font-size: 14px;
            font-weight: 500;
        }

        .nav-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .nav-item.active {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .nav-item .material-icons {
            font-size: 20px;
        }

        /* Mobile Menu */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 8px;
        }

        .mobile-menu-btn .material-icons {
            font-size: 24px;
        }

        @media (max-width: 768px) {
            .header-nav {
                display: none;
                position: absolute;
                top: 64px;
                left: 0;
                right: 0;
                background-color: #6200ea;
                flex-direction: column;
                padding: 8px;
                box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            }

            .header-nav.mobile-open {
                display: flex;
            }

            .nav-item {
                width: 100%;
                justify-content: flex-start;
            }

            .mobile-menu-btn {
                display: block;
            }
        }

        /* Main Content */
        .main-content {
            flex: 1;
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
            padding: 24px 16px;
        }

        /* Footer Styles */
        .app-footer {
            background-color: #424242;
            color: #e0e0e0;
            margin-top: auto;
            border-top: 1px solid #616161;
        }

        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 32px 16px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 32px;
            margin-bottom: 24px;
        }

        .footer-section h3 {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 16px;
            color: white;
        }

        .footer-section p,
        .footer-section a {
            font-size: 14px;
            color: #e0e0e0;
            line-height: 1.6;
            text-decoration: none;
            display: block;
            margin-bottom: 8px;
        }

        .footer-section a:hover {
            color: #bb86fc;
        }

        .footer-social {
            display: flex;
            gap: 12px;
            margin-top: 12px;
        }

        .social-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: #616161;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-decoration: none;
            transition: background-color 0.2s;
        }

        .social-icon:hover {
            background-color: #bb86fc;
        }

        .social-icon .material-icons {
            font-size: 20px;
        }

        .footer-divider {
            height: 1px;
            background-color: #616161;
            margin: 24px 0;
        }

        .footer-bottom {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
            font-size: 14px;
        }

        .footer-links {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .footer-links a {
            color: #e0e0e0;
            text-decoration: none;
        }

        .footer-links a:hover {
            color: #bb86fc;
        }

        @media (max-width: 768px) {
            .footer-bottom {
                flex-direction: column;
                text-align: center;
            }
        }

        /* Map specific styles */
        .map-container {
            width: 100%;
            height: calc(100vh - 64px - 200px); /* viewport - header - footer */
            min-height: 600px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            position: relative;
        }

        #map {
            width: 100%;
            height: 100%;
        }

        .map-controls {
            position: absolute;
            top: 16px;
            left: 16px;
            right: 16px;
            z-index: 100;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .search-box {
            background: white;
            border-radius: 8px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            flex: 1;
            min-width: 300px;
        }

        .search-box input {
            border: none;
            outline: none;
            font-size: 14px;
            flex: 1;
            padding: 0;
        }

        .search-box .material-icons {
            color: #757575;
            font-size: 20px;
        }

        .search-box button {
            background: none;
            border: none;
            padding: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            color: #6200ea;
        }

        .search-box button:hover {
            color: #3700b3;
        }

        .filter-btn {
            background: white;
            border: none;
            border-radius: 8px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: #424242;
            transition: all 0.2s;
        }

        .filter-btn:hover {
            background-color: #f5f5f5;
        }

        .filter-btn .material-icons {
            font-size: 20px;
        }

        .map-info {
            margin-top: 24px;
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .map-info h3 {
            font-size: 20px;
            font-weight: 500;
            margin-bottom: 16px;
            color: #212121;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
        }

        .info-card {
            padding: 16px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            transition: all 0.2s;
            cursor: pointer;
        }

        .info-card:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .info-card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .info-card-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #e1bee7;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6200ea;
        }

        .info-card-icon .material-icons {
            font-size: 24px;
        }

        .info-card h4 {
            font-size: 16px;
            font-weight: 500;
            color: #212121;
        }

        .info-card p {
            font-size: 14px;
            color: #757575;
            line-height: 1.5;
        }

        /* Custom Marker Info Window */
        .custom-infowindow {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            padding: 16px;
            min-width: 250px;
        }

        .infowindow-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 12px;
        }

        .infowindow-title {
            font-size: 16px;
            font-weight: 500;
            color: #212121;
            margin-bottom: 4px;
        }

        .infowindow-rating {
            color: #f57c00;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .infowindow-body {
            font-size: 14px;
            color: #757575;
            line-height: 1.6;
        }

        .infowindow-body p {
            margin: 4px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .infowindow-body .material-icons {
            font-size: 18px;
            color: #9e9e9e;
        }

        .infowindow-close {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0;
            color: #757575;
            display: flex;
            align-items: center;
        }

        .infowindow-close:hover {
            color: #212121;
        }

        .infowindow-close .material-icons {
            font-size: 20px;
        }

        .infowindow-footer {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 8px;
        }

        .infowindow-btn {
            flex: 1;
            padding: 8px 12px;
            border: none;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            transition: all 0.2s;
        }

        .infowindow-btn-primary {
            background-color: #6200ea;
            color: white;
        }

        .infowindow-btn-primary:hover {
            background-color: #3700b3;
        }

        .infowindow-btn-secondary {
            background-color: #f5f5f5;
            color: #424242;
        }

        .infowindow-btn-secondary:hover {
            background-color: #eeeeee;
        }

        .infowindow-btn .material-icons {
            font-size: 16px;
        }

        /* Loading Indicator */
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 24px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            display: none;
            z-index: 1000;
        }

        .loading.active {
            display: block;
        }

        @media (max-width: 768px) {
            .map-container {
                height: calc(100vh - 64px - 100px);
                min-height: 400px;
            }

            .map-controls {
                flex-direction: column;
            }

            .search-box {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <header class="app-header">
        <div class="header-container">
            <a href="/" class="header-logo">
                <span class="material-icons">toys</span>
                <span>인형뽑기방</span>
            </a>

            <nav class="header-nav" id="headerNav">
                <a href="/map" class="nav-item active">
                    <span class="material-icons">map</span>
                    <span>지도</span>
                </a>
                <a href="/community" class="nav-item">
                    <span class="material-icons">forum</span>
                    <span>커뮤니티</span>
                </a>
                <a href="/doll" class="nav-item">
                    <span class="material-icons">smart_toy</span>
                    <span>인형정보</span>
                </a>
            </nav>

            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <span class="material-icons">menu</span>
            </button>
        </div>
    </header>

    <main class="main-content">
        <div class="map-container">
            <div id="map"></div>

            <div class="map-controls">
                <div class="search-box">
                    <span class="material-icons">search</span>
                    <input type="text" id="searchInput" placeholder="매장 또는 지역 검색" onkeypress="if(event.key === 'Enter') searchPlaces()">
                    <button onclick="getCurrentLocation()">
                        <span class="material-icons">my_location</span>
                    </button>
                    <button onclick="searchPlaces()">
                        <span class="material-icons">search</span>
                    </button>
                </div>
                <button class="filter-btn" onclick="toggleClustering()">
                    <span class="material-icons">filter_list</span>
                    <span>클러스터</span>
                </button>
            </div>

            <div class="loading" id="loading">
                <span class="material-icons" style="font-size: 32px; color: #6200ea;">sync</span>
            </div>
        </div>

        <div class="map-info">
            <h3>인기 매장</h3>
            <div class="info-grid">
                <div class="info-card">
                    <div class="info-card-header">
                        <div class="info-card-icon">
                            <span class="material-icons">store</span>
                        </div>
                        <div>
                            <h4>강남 인형뽑기 타운</h4>
                        </div>
                    </div>
                    <p>서울 강남구 테헤란로 123<br>평점: ★★★★☆ 4.5</p>
                </div>

                <div class="info-card">
                    <div class="info-card-header">
                        <div class="info-card-icon">
                            <span class="material-icons">store</span>
                        </div>
                        <div>
                            <h4>홍대 UFO 캐처존</h4>
                        </div>
                    </div>
                    <p>서울 마포구 홍익로 456<br>평점: ★★★★★ 4.8</p>
                </div>

                <div class="info-card">
                    <div class="info-card-header">
                        <div class="info-card-icon">
                            <span class="material-icons">store</span>
                        </div>
                        <div>
                            <h4>신촌 토이파크</h4>
                        </div>
                    </div>
                    <p>서울 서대문구 신촌로 789<br>평점: ★★★★☆ 4.3</p>
                </div>

                <div class="info-card">
                    <div class="info-card-header">
                        <div class="info-card-icon">
                            <span class="material-icons">store</span>
                        </div>
                        <div>
                            <h4>명동 캐릭터  월드zzz</h4>
                        </div>
                    </div>
                    <p>서울 중구 명동길 321<br>평점: ★★★★☆ 4.6</p>
                </div>
            </div>
        </div>
    </main>

    <footer class="app-footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>인형뽑기방 정보</h3>
                    <p>전국의 인형뽑기방 정보를 한눈에!</p>
                    <p>매장 위치, 후기, 인형 정보까지<br>다양한 정보를 제공합니다.</p>
                    <div class="footer-social">
                        <a href="#" class="social-icon" title="Facebook">
                            <span class="material-icons">facebook</span>
                        </a>
                        <a href="#" class="social-icon" title="Instagram">
                            <span class="material-icons">camera_alt</span>
                        </a>
                        <a href="#" class="social-icon" title="Twitter">
                            <span class="material-icons">tag</span>
                        </a>
                    </div>
                </div>

                <div class="footer-section">
                    <h3>서비스</h3>
                    <a href="/map">매장 찾기</a>
                    <a href="/community">커뮤니티</a>
                    <a href="/doll">인형 정보</a>
                </div>

                <div class="footer-section">
                    <h3>고객지원</h3>
                    <a href="#">공지사항</a>
                    <a href="#">FAQ</a>
                    <a href="#">1:1 문의</a>
                    <a href="#">매장 등록 요청</a>
                </div>

                <div class="footer-section">
                    <h3>회사정보</h3>
                    <p>상호명: (주)인형뽑기방</p>
                    <p>대표자: 홍길동</p>
                    <p>사업자등록번호: 123-45-67890</p>
                    <p>주소: 서울특별시 강남구 테헤란로 123</p>
                    <p>이메일: info@dollcatcher.com</p>
                    <p>전화: 02-1234-5678</p>
                </div>
            </div>

            <div class="footer-divider"></div>

            <div class="footer-bottom">
                <div>© 2025 인형뽑기방. All rights reserved.</div>
                <div class="footer-links">
                    <a href="#">이용약관</a>
                    <a href="#">개인정보처리방침</a>
                    <a href="#">위치기반서비스 이용약관</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Mobile menu toggle
        document.getElementById('mobileMenuBtn')?.addEventListener('click', function() {
            const nav = document.getElementById('headerNav');
            nav.classList.toggle('mobile-open');
        });

        // 카카오맵 관련 변수
        let map;
        let clusterer;
        let markers = [];
        let infowindow;
        let isClusteringEnabled = true;

        // 전국 주요 인형뽑기방 데이터 (샘플 데이터)
        const dollShops = [
            // 서울
            { name: '강남 인형뽑기 타운', lat: 37.4979, lng: 127.0276, address: '서울 강남구 테헤란로 123', rating: 4.5, machines: 50 },
            { name: '홍대 UFO 캐처존', lat: 37.5563, lng: 126.9244, address: '서울 마포구 홍익로 456', rating: 4.8, machines: 40 },
            { name: '신촌 토이파크', lat: 37.5564, lng: 126.9369, address: '서울 서대문구 신촌로 789', rating: 4.3, machines: 35 },
            { name: '명동 캐릭터 월드', lat: 37.5636, lng: 126.9834, address: '서울 중구 명동길 321', rating: 4.6, machines: 45 },
            { name: '잠실 돌캐쳐', lat: 37.5133, lng: 127.1000, address: '서울 송파구 올림픽로 240', rating: 4.4, machines: 55 },
            { name: '건대입구 인형천국', lat: 37.5402, lng: 127.0695, address: '서울 광진구 능동로 120', rating: 4.2, machines: 30 },
            { name: '이태원 글로벌캐쳐', lat: 37.5345, lng: 126.9949, address: '서울 용산구 이태원로 55', rating: 4.7, machines: 38 },
            { name: '종로 레트로존', lat: 37.5704, lng: 126.9910, address: '서울 종로구 종로 88', rating: 4.1, machines: 25 },

            // 부산
            { name: '해운대 비치캐쳐', lat: 35.1587, lng: 129.1603, address: '부산 해운대구 해운대해변로 264', rating: 4.5, machines: 42 },
            { name: '서면 인형광장', lat: 35.1577, lng: 129.0595, address: '부산 부산진구 중앙대로 123', rating: 4.3, machines: 38 },
            { name: '광안리 씨뷰캐쳐', lat: 35.1532, lng: 129.1189, address: '부산 수영구 광안해변로 200', rating: 4.6, machines: 40 },
            { name: '남포동 토이월드', lat: 35.0971, lng: 129.0287, address: '부산 중구 광복로 45', rating: 4.2, machines: 35 },

            // 대구
            { name: '동성로 캐쳐스트리트', lat: 35.8695, lng: 128.5934, address: '대구 중구 동성로2가 81', rating: 4.4, machines: 36 },
            { name: '수성못 인형나라', lat: 35.8242, lng: 128.6308, address: '대구 수성구 두산동 180', rating: 4.5, machines: 32 },

            // 인천
            { name: '송도 스마트캐쳐', lat: 37.3786, lng: 126.6562, address: '인천 연수구 센트럴로 123', rating: 4.6, machines: 45 },
            { name: '부평 인형타운', lat: 37.5077, lng: 126.7236, address: '인천 부평구 부평대로 55', rating: 4.3, machines: 33 },

            // 대전
            { name: '둔산동 캐쳐존', lat: 36.3504, lng: 127.3845, address: '대전 서구 둔산로 123', rating: 4.4, machines: 35 },
            { name: '유성 온천캐쳐', lat: 36.3566, lng: 127.3423, address: '대전 유성구 온천로 88', rating: 4.2, machines: 28 },

            // 광주
            { name: '충장로 돌캐쳐', lat: 35.1492, lng: 126.9172, address: '광주 동구 충장로 50', rating: 4.5, machines: 34 },
            { name: '상무지구 인형월드', lat: 35.1520, lng: 126.8533, address: '광주 서구 상무대로 777', rating: 4.3, machines: 30 },

            // 울산
            { name: '삼산동 캐쳐파크', lat: 35.5372, lng: 129.3390, address: '울산 남구 삼산로 123', rating: 4.4, machines: 32 },

            // 경기도
            { name: '수원역 인형천국', lat: 37.2661, lng: 127.0015, address: '경기 수원시 팔달구 덕영대로 924', rating: 4.3, machines: 38 },
            { name: '분당 판교캐쳐', lat: 37.3941, lng: 127.1111, address: '경기 성남시 분당구 판교역로 166', rating: 4.7, machines: 48 },
            { name: '일산 호수공원캐쳐', lat: 37.6638, lng: 126.7684, address: '경기 고양시 일산동구 호수로 731', rating: 4.5, machines: 40 },
            { name: '안양 평촌캐쳐', lat: 37.3896, lng: 126.9515, address: '경기 안양시 동안구 관평로 182', rating: 4.2, machines: 30 },
            { name: '용인 기흥캐쳐', lat: 37.2767, lng: 127.1163, address: '경기 용인시 기흥구 강남로 56', rating: 4.4, machines: 35 },
        ];

        // 지도 초기화
        function initMap() {
            const container = document.getElementById('map');
            const options = {
                center: new kakao.maps.LatLng(36.5, 127.5), // 한국 중심부
                level: 13 // 전국이 보이는 레벨
            };

            map = new kakao.maps.Map(container, options);
            infowindow = new kakao.maps.InfoWindow({zIndex: 1});

            // 마커 클러스터러 초기화
            clusterer = new kakao.maps.MarkerClusterer({
                map: map,
                averageCenter: true,
                minLevel: 8,
                calculator: [10, 30, 50],
                styles: [{
                    width: '40px',
                    height: '40px',
                    background: '#6200ea',
                    borderRadius: '20px',
                    color: '#fff',
                    textAlign: 'center',
                    lineHeight: '40px',
                    fontSize: '14px',
                    fontWeight: 'bold'
                }, {
                    width: '50px',
                    height: '50px',
                    background: '#3700b3',
                    borderRadius: '25px',
                    color: '#fff',
                    textAlign: 'center',
                    lineHeight: '50px',
                    fontSize: '15px',
                    fontWeight: 'bold'
                }, {
                    width: '60px',
                    height: '60px',
                    background: '#1a0052',
                    borderRadius: '30px',
                    color: '#fff',
                    textAlign: 'center',
                    lineHeight: '60px',
                    fontSize: '16px',
                    fontWeight: 'bold'
                }]
            });

            // 마커 생성
            createMarkers();
        }

        // 마커 생성
        function createMarkers() {
            markers = dollShops.map(shop => {
                const position = new kakao.maps.LatLng(shop.lat, shop.lng);

                const marker = new kakao.maps.Marker({
                    position: position,
                    title: shop.name
                });

                // 마커 클릭 이벤트
                kakao.maps.event.addListener(marker, 'click', function() {
                    displayShopInfo(shop, marker);
                });

                return marker;
            });

            // 클러스터러에 마커 추가
            if (isClusteringEnabled) {
                clusterer.addMarkers(markers);
            } else {
                markers.forEach(marker => marker.setMap(map));
            }
        }

        // 매장 정보 표시
        function displayShopInfo(shop, marker) {
            const stars = '★'.repeat(Math.floor(shop.rating)) + '☆'.repeat(5 - Math.floor(shop.rating));

            const content = `
                <div class="custom-infowindow">
                    <div class="infowindow-header">
                        <div>
                            <div class="infowindow-title">${shop.name}</div>
                            <div class="infowindow-rating">
                                ${stars} ${shop.rating}
                            </div>
                        </div>
                        <button class="infowindow-close" onclick="closeInfowindow()">
                            <span class="material-icons">close</span>
                        </button>
                    </div>
                    <div class="infowindow-body">
                        <p>
                            <span class="material-icons">location_on</span>
                            ${shop.address}
                        </p>
                        <p>
                            <span class="material-icons">toys</span>
                            기계 ${shop.machines}대
                        </p>
                    </div>
                    <div class="infowindow-footer">
                        <button class="infowindow-btn infowindow-btn-primary" onclick="viewShopDetail('${shop.name}')">
                            <span class="material-icons">info</span>
                            상세보기
                        </button>
                        <button class="infowindow-btn infowindow-btn-secondary" onclick="getDirections(${shop.lat}, ${shop.lng})">
                            <span class="material-icons">directions</span>
                            길찾기
                        </button>
                    </div>
                </div>
            `;

            infowindow.setContent(content);
            infowindow.open(map, marker);
        }

        // 인포윈도우 닫기
        function closeInfowindow() {
            infowindow.close();
        }

        // 클러스터링 토글
        function toggleClustering() {
            isClusteringEnabled = !isClusteringEnabled;

            if (isClusteringEnabled) {
                // 개별 마커 제거
                markers.forEach(marker => marker.setMap(null));
                // 클러스터러에 마커 추가
                clusterer.addMarkers(markers);
            } else {
                // 클러스터 제거
                clusterer.clear();
                // 개별 마커 표시
                markers.forEach(marker => marker.setMap(map));
            }
        }

        // 현재 위치로 이동
        function getCurrentLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    const locPosition = new kakao.maps.LatLng(lat, lng);

                    map.setCenter(locPosition);
                    map.setLevel(5);

                    // 현재 위치 마커 표시
                    const marker = new kakao.maps.Marker({
                        position: locPosition,
                        map: map
                    });

                    const content = '<div style="padding:10px;background:white;border-radius:5px;box-shadow:0 2px 6px rgba(0,0,0,0.3);">현재 위치</div>';
                    const customOverlay = new kakao.maps.CustomOverlay({
                        position: locPosition,
                        content: content,
                        yAnchor: 2.5
                    });
                    customOverlay.setMap(map);
                }, function(error) {
                    alert('현재 위치를 가져올 수 없습니다.');
                });
            } else {
                alert('이 브라우저는 Geolocation을 지원하지 않습니다.');
            }
        }

        // 장소 검색
        function searchPlaces() {
            const keyword = document.getElementById('searchInput').value.trim();

            if (!keyword) {
                alert('검색어를 입력해주세요.');
                return;
            }

            // 샘플 데이터에서 검색
            const results = dollShops.filter(shop =>
                shop.name.includes(keyword) || shop.address.includes(keyword)
            );

            if (results.length > 0) {
                const firstResult = results[0];
                const position = new kakao.maps.LatLng(firstResult.lat, firstResult.lng);
                map.setCenter(position);
                map.setLevel(3);

                // 해당 매장의 마커 찾아서 정보 표시
                const marker = markers[dollShops.indexOf(firstResult)];
                displayShopInfo(firstResult, marker);
            } else {
                alert('검색 결과가 없습니다.');
            }
        }

        // 매장 상세보기
        function viewShopDetail(shopName) {
            alert(`${shopName} 상세 페이지로 이동합니다.\n(추후 구현 예정)`);
        }

        // 길찾기
        function getDirections(lat, lng) {
            const kakaoMapUrl = `https://map.kakao.com/link/to/목적지,${lat},${lng}`;
            window.open(kakaoMapUrl, '_blank');
        }

        // 페이지 로드 시 지도 초기화
        window.onload = function() {
            initMap();
        };
    </script>
</body>
</html>

