# 다음 개발 계획

## ✅ 서버 기본 구성 완료!

### 완료된 항목
| 항목 | 상태 | 설명 |
|------|------|------|
| 인증/인가 | ✅ | JWT + OAuth2 (카카오/구글) |
| Access Token 자동 재발급 | ✅ | 웹(쿠키)/앱(헤더) 모두 지원 |
| 공통 API 응답 | ✅ | `ApiResponse<T>` |
| 공통 에러 처리 | ✅ | `GlobalExceptionHandler` |
| 유효성 검증 | ✅ | `@Valid` + DTO |
| 통합 테스트 | ✅ | 58개 테스트 |
| Swagger | ✅ | `http://localhost:8080/swagger-ui.html` |
| Actuator | ✅ | `http://localhost:8080/actuator/health` |
| Logback 로깅 | ✅ | `logs/application.log`, `logs/error.log` |
| CORS 설정 | ✅ | 프론트 분리 시 대비 |
| 패키지 구조 정리 | ✅ | handler, repository 분리 |

---

## 🚀 다음 단계: 배포!

### Phase 2: 배포 + 인프라
| 순서 | 항목 | 소요시간 | 설명 |
|------|------|----------|------|
| 1 | **application-prod.yml** | 30분 | 운영 환경 설정 분리 |
| 2 | **Dockerfile 작성** | 1시간 | 배포 준비 |
| 3 | **Docker Compose** | 1시간 | App + DB |
| 4 | **AWS/클라우드 배포** | 2~4시간 | EC2 또는 Railway |
| 5 | **HTTPS + 도메인** | 1~2시간 | Let's Encrypt |

### Phase 3: 성능 최적화 (선택)
| 순서 | 항목 | 소요시간 | 설명 |
|------|------|----------|------|
| 6 | **Redis 적용** | 2시간 | Refresh Token → Redis |
| 7 | **캐싱 적용** | 2시간 | 자주 조회 데이터 캐싱 |

---

## 📋 배포 상세

**Docker Compose 예시:**
```yaml
version: '3.8'
services:
  app:
    build: .
    ports:
      - "8080:8080"
    depends_on:
      - db
    environment:
      - SPRING_PROFILES_ACTIVE=prod

  db:
    image: mariadb:10.11
    environment:
      - MYSQL_ROOT_PASSWORD=root
      - MYSQL_DATABASE=doll_gacha
    volumes:
      - db_data:/var/lib/mysql

volumes:
  db_data:
```

**배포 옵션:**
| 옵션 | 비용 | 난이도 |
|------|------|--------|
| AWS EC2 + Docker Compose | 무료~유료 | ⭐⭐ |
| Railway | 무료~유료 | ⭐ 쉬움 |

---

## 📱 앱 개발 관련

서버 `RefreshController`가 웹/앱 모두 지원하도록 구현됨:

| 구분 | 웹 (브라우저) | 앱 (Flutter 등) |
|------|-------------|-----------------|
| 토큰 저장 | HttpOnly 쿠키 | SecureStorage |
| 재발급 요청 | 쿠키 자동 전송 | Authorization 헤더 |
| 새 토큰 응답 | Set-Cookie | JSON |

---

## 📝 배포 전 확인사항

- [ ] `application.yml`에서 `expiration_access: 1800000` (30분)으로 변경
- [ ] `application-prod.yml` 생성
- [ ] DB 비밀번호 등 민감 정보 환경변수로 분리
- [ ] OAuth2 콜백 URL 운영 도메인으로 변경




CI/CD :  깃허브 커밋 => actions
